<div class="flex flex-col gap-y-8">
  <section
    class="flex p-4 gap-x-6 rounded-xl bg-violet-50 border border-violet-300 shadow-sm"
  >
    <div
      class="relative w-5 h-5 rounded-full before:absolute before:top-1/2 before:left-1/2 before:-translate-x-1/2 before:-translate-y-1/2 before:w-[28px] before:h-[28px] before:rounded-full before:border-2 before:border-violet-600/30 after:absolute after:top-1/2 after:left-1/2 after:-translate-x-1/2 after:-translate-y-1/2 after:w-[38px] after:h-[38px] after:rounded-full after:border-2 after:border-violet-600/10"
    >
      <img
        src="../../../../../../../assets/svgs/info-circle.svg"
        class="w-5 h-5"
      />
    </div>
    <p class="flex-1 font-normal text-sm text-violet-600">
      Para realizar a sua inscrição é necessário que o Termo de compromisso
      abaixo seja assinado. Confira suas informações antes da assinatura.<br />
      <br />Caso não possa assinar neste momento, seus dados ficarão salvos e
      você poderá acessar a inscrição novamente em "Meus cursos".
    </p>
  </section>

  <section
    class="flex flex-col p-8 gap-y-6 rounded-2xl bg-white border border-gray-200 shadow-sm"
  >
    <h1 class="font-semibold text-lg text-black">Termo de compromisso</h1>

    <div
      class="flex items-center justify-between px-8 py-6 rounded-2xl bg-white border border-gray-200 shadow-sm"
    >
      <div class="flex flex-col gap-1">
        <h1 class="font-semibold text-sm text-gray-600">
          Termo de compromisso
        </h1>
        <p class="w-[445px] font-normal text-sm text-gray-600 uppercase">
          {{ course.sigla }} - {{ course.nome }}
        </p>
      </div>
      <button
        *ngIf="!termo_compromisso_assinado?.value"
        class="h-fit px-4 py-[10px] rounded-lg font-semibold text-sm text-gray-700 shadow-sm border border-gray-300"
        type="button"
        (click)="openSignatureModal()"
      >
        Assinar
      </button>
      <div
        *ngIf="termo_compromisso_assinado?.value"
        class="h-fit px-4 py-[10px] rounded-lg font-semibold text-sm text-emerald-600 shadow-sm border border-emerald-300 bg-emerald-100"
      >
        Assinado
      </div>
    </div>

    <hr class="h-[1px] bg-gray-200" />

    <div class="flex justify-between items-center">
      <button
        class="px-4 py-[10px] rounded-lg font-semibold text-sm text-violet-700"
        (click)="backStep.emit()"
      >
        Voltar
      </button>
      <div class="flex gap-x-[15px]">
        <button
          *ngIf="!termo_compromisso_assinado?.value"
          class="px-4 py-[10px] rounded-lg font-semibold text-sm text-violet-700"
          (click)="nextStep.emit()"
        >
          Assinar depois
        </button>
        <button
          class="px-4 py-[10px] rounded-lg font-semibold text-sm text-white bg-violet-700"
          (click)="nextStep.emit()"
          [disabled]="!termo_compromisso_assinado?.value"
        >
          Próximo
        </button>
      </div>
    </div>
  </section>
</div>

<div
  [ngClass]="{
    flex: signatureModalOpened,
    hidden: !signatureModalOpened
  }"
  class="absolute items-center justify-center top-0 left-0 w-screen h-screen bg-black/50 z-50 backdrop-blur-sm"
>
  <div
    class="flex flex-col gap-y-6 p-6 bg-white rounded-2xl w-[1000px] h-[630px]"
  >
    <div class="flex justify-between">
      <h1 class="font-semibold text-lg text-gray-900">
        Assinatura de Termo de compromisso
      </h1>
      <div class="flex items-center justify-center w-11 h-11">
        <button (click)="closeSignatureModal()" class="w-6 h-6">
          <img
            src="../../../../../../../../assets/svgs/x-close.svg"
            class="w-6 h-6"
          />
        </button>
      </div>
    </div>
    <div
      class="relative w-full h-full rounded-2xl border border-gray-200 overflow-hidden"
    >
      <canvas
        #signatureCanvas
        (mousedown)="startDrawing($event)"
        (mousemove)="draw($event)"
        (mouseup)="stopDrawing()"
        (mouseout)="stopDrawing()"
      ></canvas>
      <div class="absolute bottom-6 gap-x-4 left-1/2 -translate-x-1/2 z-50">
        <button
          class="px-4 py-[10px] rounded-lg font-semibold text-sm text-violet-700"
          type="button"
          (click)="clearSignatureCanvas()"
        >
          Limpar
        </button>
        <button
          class="px-4 py-[10px] rounded-lg bg-violet-600 font-semibold text-sm text-white"
          type="button"
          (click)="handleSendSignature()"
        >
          Assinar
        </button>
      </div>
    </div>
  </div>
</div>
